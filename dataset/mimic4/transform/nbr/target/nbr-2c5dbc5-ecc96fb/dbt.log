{"data": {"log_version": 3, "version": "=1.10.13"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "Running with dbt=1.10.13", "name": "MainReportVersion", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.412834Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt build --select nbr.curated.events_merged", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2c5dbc5-ecc96fb", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "target/nbr-2c5dbc5-ecc96fb", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptionsV2(error=[], warn=[], silence=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'log_path': '/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2c5dbc5-ecc96fb', 'introspect': 'True', 'log_format': 'json', 'static_parser': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'version_check': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'write_json': 'True', 'target_path': 'target/nbr-2c5dbc5-ecc96fb', 'quiet': 'False', 'debug': 'False', 'use_colors': 'True', 'invocation_command': 'dbt build --select nbr.curated.events_merged', 'profiles_dir': '/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr', 'indirect_selection': 'eager'}", "name": "MainReportArgs", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.414994Z"}}
{"data": {"adapter_name": "duckdb", "adapter_version": "=1.9.6"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "Registered adapter: duckdb=1.9.6", "name": "AdapterRegistered", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.537265Z"}}
{"data": {"checksum": "9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe", "profile": "", "target": "", "vars": "{}", "version": "1.10.13"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13", "name": "StateCheckVarsHash", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.582220Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.622086Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.622329Z"}}
{"data": {"artifact_path": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2c5dbc5-ecc96fb/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Wrote artifact WritableManifest to /Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2c5dbc5-ecc96fb/manifest.json", "name": "ArtifactWritten", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.665265Z"}}
{"data": {"artifact_path": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2c5dbc5-ecc96fb/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Wrote artifact SemanticManifest to /Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2c5dbc5-ecc96fb/semantic_manifest.json", "name": "ArtifactWritten", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.666767Z"}}
{"data": {"stat_line": "7 models, 7 sources, 444 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "Found 7 models, 7 sources, 444 macros", "name": "FoundStats", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.677936Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "", "name": "Formatting", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.678739Z"}}
{"data": {"node_count": 1, "num_threads": 1, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "Concurrency: 1 threads (target='dev')", "name": "ConcurrencyLine", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.678923Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "", "name": "Formatting", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.679067Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Acquiring new duckdb connection 'master'", "name": "NewConnection", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.679295Z"}}
{"data": {"conn_name": "list_mimic4", "conn_type": "duckdb"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Acquiring new duckdb connection 'list_mimic4'", "name": "NewConnection", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.679671Z"}}
{"data": {"conn_name": "list_mimic4", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"list_mimic4\"", "name": "ConnectionUsed", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.702922Z"}}
{"data": {"conn_name": "list_mimic4", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"list_mimic4\"} */\n\n    \n    select schema_name\n    from system.information_schema.schemata\n    \n    where lower(catalog_name) = '\"mimic4\"'\n    \n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On list_mimic4: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"list_mimic4\"} */\n\n    \n    select schema_name\n    from system.information_schema.schemata\n    \n    where lower(catalog_name) = '\"mimic4\"'\n    \n  \n  ", "name": "SQLQuery", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.703195Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.703379Z"}}
{"data": {"elapsed": 0.008410833, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.008 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.711809Z"}}
{"data": {"conn_name": "list_mimic4"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On list_mimic4: Close", "name": "ConnectionClosed", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.712470Z"}}
{"data": {"conn_name": "create_mimic4_main", "orig_conn_name": "list_mimic4"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_mimic4, now create_mimic4_main)", "name": "ConnectionReused", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.712804Z"}}
{"data": {"relation": {"database": "mimic4", "identifier": "", "schema": "main"}}, "info": {"category": "", "code": "E020", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Creating schema \"database: \"mimic4\"\nschema: \"main\"\n\"", "name": "SchemaCreation", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.713023Z"}}
{"data": {"conn_name": "create_mimic4_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"create_mimic4_main\"", "name": "ConnectionUsed", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.715565Z"}}
{"data": {"conn_name": "create_mimic4_main", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"create_mimic4_main\"} */\n\n    \n        select type from duckdb_databases()\n        where lower(database_name)='mimic4'\n        and type='sqlite'\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On create_mimic4_main: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"create_mimic4_main\"} */\n\n    \n        select type from duckdb_databases()\n        where lower(database_name)='mimic4'\n        and type='sqlite'\n    \n  ", "name": "SQLQuery", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.715736Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.715883Z"}}
{"data": {"elapsed": 0.00036862498, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.716259Z"}}
{"data": {"conn_name": "create_mimic4_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"create_mimic4_main\"", "name": "ConnectionUsed", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.716750Z"}}
{"data": {"conn_name": "create_mimic4_main", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On create_mimic4_main: BEGIN", "name": "SQLQuery", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.716900Z"}}
{"data": {"elapsed": 7.0334e-05, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.717109Z"}}
{"data": {"conn_name": "create_mimic4_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"create_mimic4_main\"", "name": "ConnectionUsed", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.717247Z"}}
{"data": {"conn_name": "create_mimic4_main", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"create_mimic4_main\"} */\n\n    \n    \n        create schema if not exists \"mimic4\".\"main\"\n    "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On create_mimic4_main: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"create_mimic4_main\"} */\n\n    \n    \n        create schema if not exists \"mimic4\".\"main\"\n    ", "name": "SQLQuery", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.717377Z"}}
{"data": {"elapsed": 9.3833e-05, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.717629Z"}}
{"data": {"conn_name": "create_mimic4_main"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On create_mimic4_main: COMMIT", "name": "SQLCommit", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.717964Z"}}
{"data": {"conn_name": "create_mimic4_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"create_mimic4_main\"", "name": "ConnectionUsed", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.718105Z"}}
{"data": {"conn_name": "create_mimic4_main", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On create_mimic4_main: COMMIT", "name": "SQLQuery", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.718236Z"}}
{"data": {"elapsed": 8.2292e-05, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.718457Z"}}
{"data": {"conn_name": "create_mimic4_main"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On create_mimic4_main: Close", "name": "ConnectionClosed", "pid": 35370, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:40:23.718630Z"}}
{"data": {"conn_name": "list_mimic4_main", "orig_conn_name": "create_mimic4_main"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Re-using an available connection from the pool (formerly create_mimic4_main, now list_mimic4_main)", "name": "ConnectionReused", "pid": 35370, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:40:23.720753Z"}}
{"data": {"conn_name": "list_mimic4_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"list_mimic4_main\"", "name": "ConnectionUsed", "pid": 35370, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:40:23.722950Z"}}
{"data": {"conn_name": "list_mimic4_main", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On list_mimic4_main: BEGIN", "name": "SQLQuery", "pid": 35370, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:40:23.723104Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 35370, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:40:23.723234Z"}}
{"data": {"elapsed": 0.00021495801, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:40:23.723454Z"}}
{"data": {"conn_name": "list_mimic4_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"list_mimic4_main\"", "name": "ConnectionUsed", "pid": 35370, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:40:23.723597Z"}}
{"data": {"conn_name": "list_mimic4_main", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"list_mimic4_main\"} */\nselect\n      'mimic4' as database,\n      table_name as name,\n      table_schema as schema,\n      CASE table_type\n        WHEN 'BASE TABLE' THEN 'table'\n        WHEN 'VIEW' THEN 'view'\n        WHEN 'LOCAL TEMPORARY' THEN 'table'\n        END as type\n    from system.information_schema.tables\n    where lower(table_schema) = 'main'\n    and lower(table_catalog) = 'mimic4'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On list_mimic4_main: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"list_mimic4_main\"} */\nselect\n      'mimic4' as database,\n      table_name as name,\n      table_schema as schema,\n      CASE table_type\n        WHEN 'BASE TABLE' THEN 'table'\n        WHEN 'VIEW' THEN 'view'\n        WHEN 'LOCAL TEMPORARY' THEN 'table'\n        END as type\n    from system.information_schema.tables\n    where lower(table_schema) = 'main'\n    and lower(table_catalog) = 'mimic4'\n  ", "name": "SQLQuery", "pid": 35370, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:40:23.723736Z"}}
{"data": {"elapsed": 0.005828459, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.006 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:40:23.729718Z"}}
{"data": {"conn_name": "list_mimic4_main"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On list_mimic4_main: ROLLBACK", "name": "Rollback", "pid": 35370, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:40:23.730379Z"}}
{"data": {"conn_name": "list_mimic4_main", "exc_info": "Traceback (most recent call last):\n  File \"/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/.venv/lib/python3.13/site-packages/dbt/adapters/base/connections.py\", line 328, in _rollback_handle\n    connection.handle.rollback()\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'DuckDBConnectionWrapper' object has no attribute 'rollback'\n"}, "info": {"category": "", "code": "E009", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Failed to rollback 'list_mimic4_main'", "name": "RollbackFailed", "pid": 35370, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:40:23.730901Z"}}
{"data": {"conn_name": "list_mimic4_main"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On list_mimic4_main: Close", "name": "ConnectionClosed", "pid": 35370, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:40:23.731068Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"master\"", "name": "ConnectionUsed", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.731940Z"}}
{"data": {"conn_name": "master", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On master: BEGIN", "name": "SQLQuery", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.732133Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.732279Z"}}
{"data": {"elapsed": 0.000259208, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.732550Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.732709Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"master\"", "name": "ConnectionUsed", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.732841Z"}}
{"data": {"conn_name": "master", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On master: COMMIT", "name": "SQLQuery", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.732978Z"}}
{"data": {"elapsed": 6.558299e-05, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.733179Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:23.733323Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "started", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Began running node model.nbr.events_merged", "name": "NodeStart", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.734237Z"}}
{"data": {"description": "sql table model main.events_merged", "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "started", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "1 of 1 START sql table model main.events_merged ................................ [RUN]", "name": "LogStartLine", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.734516Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "orig_conn_name": "list_mimic4_main"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_mimic4_main, now model.nbr.events_merged)", "name": "ConnectionReused", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.734755Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Began compiling node model.nbr.events_merged", "name": "NodeCompiling", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.734923Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Writing injected SQL for node \"model.nbr.events_merged\"", "name": "WritingInjectedSQLForNode", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.738161Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Began executing node model.nbr.events_merged", "name": "NodeExecuting", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.738751Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nbr.events_merged\"", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Writing runtime sql for node \"model.nbr.events_merged\"", "name": "JinjaLogDebug", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.752464Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "conn_type": "duckdb", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"model.nbr.events_merged\"", "name": "ConnectionUsed", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.753176Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On model.nbr.events_merged: BEGIN", "name": "SQLQuery", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.753378Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.753559Z"}}
{"data": {"elapsed": 0.000357166, "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.753922Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "conn_type": "duckdb", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"model.nbr.events_merged\"", "name": "ConnectionUsed", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.754112Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"node_id\": \"model.nbr.events_merged\"} */\n\n  \n    \n    \n\n    create  table\n      \"mimic4\".\"main\".\"events_merged__dbt_tmp\"\n  \n    as (\n      \n\n/*\nCurated: Events Merged (\u4e8b\u4ef6\u5408\u5e76 - ETHOS Pipeline \u6838\u5fc3)\n\n\u529f\u80fd:\n1. \u5408\u5e76 4 \u7c7b\u4e8b\u4ef6\uff08DX + PR + LAB + MED\uff09\n2. \u8ba1\u7b97\u65f6\u95f4\u504f\u79fb\uff08\u8ddd\u5165\u9662\u5c0f\u65f6\u6570\uff09\n3. \u5168\u5c40\u65f6\u95f4\u6392\u5e8f\uff08ETHOS \u5173\u952e\u7279\u6027\uff09\n\nETHOS \u7b56\u7565:\n- \u6240\u6709\u4e8b\u4ef6\u6309\u5b9e\u9645\u53d1\u751f\u65f6\u95f4\u6392\u5e8f\n- \u4e0d\u6309\u7c7b\u578b\u5206\u7ec4\n- \u4fdd\u7559\u65f6\u95f4\u4fe1\u606f\u7528\u4e8e\u540e\u7eed\u63d2\u5165 TIME_BIN\n\n\u8f93\u51fa:\n- \u6bcf\u884c = \u4e00\u4e2a\u4e8b\u4ef6\uff08\u8bca\u65ad/\u624b\u672f/\u68c0\u9a8c/\u7528\u836f\uff09\n- \u6309 subject_id, visit_seq, \u65f6\u95f4 \u6392\u5e8f\n- \u5305\u542b time_offset_hours \u7528\u4e8e TIME_BIN \u751f\u6210\n*/\n\n-- ============================================================================\n-- Step 1: \u5408\u5e76\u6240\u6709\u4e8b\u4ef6\n-- ============================================================================\nwith all_events as (\n    select * from \"mimic4\".\"main\".\"stg_diagnoses\"\n    union all\n    select * from \"mimic4\".\"main\".\"stg_procedures\"\n    union all\n    select * from \"mimic4\".\"main\".\"stg_labs\"\n    union all\n    select * from \"mimic4\".\"main\".\"stg_medications\"\n),\n\n-- ============================================================================\n-- Step 2: \u5173\u8054\u5c31\u8bca\u4fe1\u606f\u5e76\u8ba1\u7b97\u65f6\u95f4\u504f\u79fb\n-- ============================================================================\nevents_with_time as (\n    select \n        a.subject_id,\n        a.hadm_id,\n        a.admittime,\n        a.visit_seq,\n        a.days_since_prior_admission,\n        e.code,\n        e.code_type,\n        e.event_time,\n        \n        -- \u8ba1\u7b97\u65f6\u95f4\u504f\u79fb\uff08\u5c0f\u65f6\uff09\n        -- \u7b56\u7565\uff1a\u8bca\u65ad\u65e0\u65f6\u95f4\uff0c\u653e\u5728\u6700\u524d\u9762\uff08-0.001\u5c0f\u65f6\uff09\n        case \n            when e.event_time is null then -0.001\n            else extract(epoch from (e.event_time - a.admittime)) / 3600.0\n        end as time_offset_hours\n        \n    from \"mimic4\".\"main\".\"stg_admissions\" a\n    join all_events e on a.hadm_id = e.hadm_id\n),\n\n-- ============================================================================\n-- Step 3: \u5168\u5c40\u65f6\u95f4\u6392\u5e8f\u5e76\u91cd\u65b0\u7f16\u53f7\n-- ============================================================================\nevents_sorted as (\n    select \n        *,\n        -- \u5168\u5c40\u5e8f\u53f7\uff08\u6309\u65f6\u95f4\u6392\u5e8f\uff09\n        row_number() over (\n            partition by subject_id, hadm_id \n            order by \n                time_offset_hours,  -- \u9996\u5148\u6309\u65f6\u95f4\n                code                -- \u65f6\u95f4\u76f8\u540c\u65f6\u6309 code \u5b57\u5178\u5e8f\uff08\u786e\u5b9a\u6027\uff09\n        ) as event_seq\n    from events_with_time\n)\n\n-- ============================================================================\n-- \u6700\u7ec8\u8f93\u51fa\n-- ============================================================================\nselect \n    subject_id,\n    hadm_id,\n    admittime,\n    visit_seq,\n    days_since_prior_admission,  -- \u2190 \u4fdd\u7559\u76f8\u5bf9\u65f6\u95f4\uff08\u7528\u4e8e Dataset cumsum\uff09\n    code,\n    code_type,\n    event_time,\n    time_offset_hours,\n    event_seq\nfrom events_sorted\norder by \n    subject_id, \n    visit_seq, \n    event_seq  -- \u2190 ETHOS \u5173\u952e\uff1a\u5168\u5c40\u65f6\u95f4\u6392\u5e8f\n    );\n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On model.nbr.events_merged: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"node_id\": \"model.nbr.events_merged\"} */\n\n  \n    \n    \n\n    create  table\n      \"mimic4\".\"main\".\"events_merged__dbt_tmp\"\n  \n    as (\n      \n\n/*\nCurated: Events Merged (\u4e8b\u4ef6\u5408\u5e76 - ETHOS Pipeline \u6838\u5fc3)\n\n\u529f\u80fd:\n1. \u5408\u5e76 4 \u7c7b\u4e8b\u4ef6\uff08DX + PR + LAB + MED\uff09\n2. \u8ba1\u7b97\u65f6\u95f4\u504f\u79fb\uff08\u8ddd\u5165\u9662\u5c0f\u65f6\u6570\uff09\n3. \u5168\u5c40\u65f6\u95f4\u6392\u5e8f\uff08ETHOS \u5173\u952e\u7279\u6027\uff09\n\nETHOS \u7b56\u7565:\n- \u6240\u6709\u4e8b\u4ef6\u6309\u5b9e\u9645\u53d1\u751f\u65f6\u95f4\u6392\u5e8f\n- \u4e0d\u6309\u7c7b\u578b\u5206\u7ec4\n- \u4fdd\u7559\u65f6\u95f4\u4fe1\u606f\u7528\u4e8e\u540e\u7eed\u63d2\u5165 TIME_BIN\n\n\u8f93\u51fa:\n- \u6bcf\u884c = \u4e00\u4e2a\u4e8b\u4ef6\uff08\u8bca\u65ad/\u624b\u672f/\u68c0\u9a8c/\u7528\u836f\uff09\n- \u6309 subject_id, visit_seq, \u65f6\u95f4 \u6392\u5e8f\n- \u5305\u542b time_offset_hours \u7528\u4e8e TIME_BIN \u751f\u6210\n*/\n\n-- ============================================================================\n-- Step 1: \u5408\u5e76\u6240\u6709\u4e8b\u4ef6\n-- ============================================================================\nwith all_events as (\n    select * from \"mimic4\".\"main\".\"stg_diagnoses\"\n    union all\n    select * from \"mimic4\".\"main\".\"stg_procedures\"\n    union all\n    select * from \"mimic4\".\"main\".\"stg_labs\"\n    union all\n    select * from \"mimic4\".\"main\".\"stg_medications\"\n),\n\n-- ============================================================================\n-- Step 2: \u5173\u8054\u5c31\u8bca\u4fe1\u606f\u5e76\u8ba1\u7b97\u65f6\u95f4\u504f\u79fb\n-- ============================================================================\nevents_with_time as (\n    select \n        a.subject_id,\n        a.hadm_id,\n        a.admittime,\n        a.visit_seq,\n        a.days_since_prior_admission,\n        e.code,\n        e.code_type,\n        e.event_time,\n        \n        -- \u8ba1\u7b97\u65f6\u95f4\u504f\u79fb\uff08\u5c0f\u65f6\uff09\n        -- \u7b56\u7565\uff1a\u8bca\u65ad\u65e0\u65f6\u95f4\uff0c\u653e\u5728\u6700\u524d\u9762\uff08-0.001\u5c0f\u65f6\uff09\n        case \n            when e.event_time is null then -0.001\n            else extract(epoch from (e.event_time - a.admittime)) / 3600.0\n        end as time_offset_hours\n        \n    from \"mimic4\".\"main\".\"stg_admissions\" a\n    join all_events e on a.hadm_id = e.hadm_id\n),\n\n-- ============================================================================\n-- Step 3: \u5168\u5c40\u65f6\u95f4\u6392\u5e8f\u5e76\u91cd\u65b0\u7f16\u53f7\n-- ============================================================================\nevents_sorted as (\n    select \n        *,\n        -- \u5168\u5c40\u5e8f\u53f7\uff08\u6309\u65f6\u95f4\u6392\u5e8f\uff09\n        row_number() over (\n            partition by subject_id, hadm_id \n            order by \n                time_offset_hours,  -- \u9996\u5148\u6309\u65f6\u95f4\n                code                -- \u65f6\u95f4\u76f8\u540c\u65f6\u6309 code \u5b57\u5178\u5e8f\uff08\u786e\u5b9a\u6027\uff09\n        ) as event_seq\n    from events_with_time\n)\n\n-- ============================================================================\n-- \u6700\u7ec8\u8f93\u51fa\n-- ============================================================================\nselect \n    subject_id,\n    hadm_id,\n    admittime,\n    visit_seq,\n    days_since_prior_admission,  -- \u2190 \u4fdd\u7559\u76f8\u5bf9\u65f6\u95f4\uff08\u7528\u4e8e Dataset cumsum\uff09\n    code,\n    code_type,\n    event_time,\n    time_offset_hours,\n    event_seq\nfrom events_sorted\norder by \n    subject_id, \n    visit_seq, \n    event_seq  -- \u2190 ETHOS \u5173\u952e\uff1a\u5168\u5c40\u65f6\u95f4\u6392\u5e8f\n    );\n  \n  ", "name": "SQLQuery", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:23.754320Z"}}
{"data": {"elapsed": 16.543686, "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 16.544 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.298915Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "conn_type": "duckdb", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"model.nbr.events_merged\"", "name": "ConnectionUsed", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.305228Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"node_id\": \"model.nbr.events_merged\"} */\nalter table \"mimic4\".\"main\".\"events_merged__dbt_tmp\" rename to \"events_merged\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On model.nbr.events_merged: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"node_id\": \"model.nbr.events_merged\"} */\nalter table \"mimic4\".\"main\".\"events_merged__dbt_tmp\" rename to \"events_merged\"", "name": "SQLQuery", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.305507Z"}}
{"data": {"elapsed": 0.000430958, "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.306144Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On model.nbr.events_merged: COMMIT", "name": "SQLCommit", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.344841Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "conn_type": "duckdb", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"model.nbr.events_merged\"", "name": "ConnectionUsed", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.345135Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On model.nbr.events_merged: COMMIT", "name": "SQLQuery", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.345330Z"}}
{"data": {"elapsed": 0.52788275, "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.528 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.873478Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "conn_type": "duckdb", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"model.nbr.events_merged\"", "name": "ConnectionUsed", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.875923Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"node_id\": \"model.nbr.events_merged\"} */\n\n      drop table if exists \"mimic4\".\"main\".\"events_merged__dbt_backup\" cascade\n    "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On model.nbr.events_merged: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"node_id\": \"model.nbr.events_merged\"} */\n\n      drop table if exists \"mimic4\".\"main\".\"events_merged__dbt_backup\" cascade\n    ", "name": "SQLQuery", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.876147Z"}}
{"data": {"elapsed": 0.000180916, "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.876524Z"}}
{"data": {"conn_name": "model.nbr.events_merged", "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.events_merged"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On model.nbr.events_merged: Close", "name": "ConnectionClosed", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.877591Z"}}
{"data": {"description": "sql table model main.events_merged", "execution_time": 17.143126, "index": 1, "node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "2025-10-23T05:40:40.877827", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "success", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "status": "OK", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "1 of 1 OK created sql table model main.events_merged ........................... [\u001b[32mOK\u001b[0m in 17.14s]", "name": "LogModelResult", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.878763Z"}}
{"data": {"node_info": {"materialized": "table", "meta": {}, "node_checksum": "edee45517d2f6a20439be886cb5dd076aeba6f2b6bc5543de4784f9bcf094dc3", "node_finished_at": "2025-10-23T05:40:40.877827", "node_name": "events_merged", "node_path": "curated/events_merged.sql", "node_relation": {"alias": "events_merged", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"events_merged\"", "schema": "main"}, "node_started_at": "2025-10-23T05:40:23.734173", "node_status": "success", "resource_type": "model", "unique_id": "model.nbr.events_merged"}, "run_result": {"adapter_response": {"_message": "OK"}, "execution_time": 17.143126, "message": "OK", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2025-10-23T05:40:23.738705Z", "name": "compile", "started_at": "2025-10-23T05:40:23.735069Z"}, {"completed_at": "2025-10-23T05:40:40.877542Z", "name": "execute", "started_at": "2025-10-23T05:40:23.738908Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Finished running node model.nbr.events_merged", "name": "NodeFinished", "pid": 35370, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:40:40.879066Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"master\"", "name": "ConnectionUsed", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.879824Z"}}
{"data": {"conn_name": "master", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On master: BEGIN", "name": "SQLQuery", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.880037Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.880204Z"}}
{"data": {"elapsed": 0.000346125, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.880551Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.880707Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Using duckdb connection \"master\"", "name": "ConnectionUsed", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.880848Z"}}
{"data": {"conn_name": "master", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On master: COMMIT", "name": "SQLQuery", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.880985Z"}}
{"data": {"elapsed": 7.1959e-05, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.881203Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.881350Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.881533Z"}}
{"data": {"conn_name": "model.nbr.events_merged"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Connection 'model.nbr.events_merged' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.881658Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "", "name": "Formatting", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.881804Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 17.20 seconds", "execution_time": 17.20259, "stat_line": "1 table model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "Finished running 1 table model in 0 hours 0 minutes and 17.20 seconds (17.20s).", "name": "FinishedRunningStats", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.881943Z"}}
{"data": {"elapsed_time": 17.20259, "generated_at": "2025-10-23T05:40:40Z", "results": [{"adapter_response": {"_message": "OK"}, "execution_time": 17.143126, "message": "OK", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2025-10-23T05:40:23.738705Z", "name": "compile", "started_at": "2025-10-23T05:40:23.735069Z"}, {"completed_at": "2025-10-23T05:40:40.877542Z", "name": "execute", "started_at": "2025-10-23T05:40:23.738908Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.882220Z"}}
{"data": {"artifact_path": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2c5dbc5-ecc96fb/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Wrote artifact WritableManifest to /Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2c5dbc5-ecc96fb/manifest.json", "name": "ArtifactWritten", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.890305Z"}}
{"data": {"artifact_path": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2c5dbc5-ecc96fb/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Wrote artifact SemanticManifest to /Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2c5dbc5-ecc96fb/semantic_manifest.json", "name": "ArtifactWritten", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.891492Z"}}
{"data": {"artifact_path": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2c5dbc5-ecc96fb/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2c5dbc5-ecc96fb/run_results.json", "name": "ArtifactWritten", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.894280Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "", "name": "Formatting", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.894473Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.894671Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "", "name": "Formatting", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.894817Z"}}
{"data": {"stats": {"error": 0, "noop": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1", "name": "StatsLine", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.894978Z"}}
{"data": {"command_name": "build", "command_success": true, "command_wall_clock_time": 17.520247, "process_in_blocks": "0", "process_kernel_time": 30.40521, "process_mem_max_rss": "17812979712", "process_out_blocks": "0", "process_user_time": 117.72077}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Resource report: {\"command_name\": \"build\", \"command_success\": true, \"command_wall_clock_time\": 17.520247, \"process_in_blocks\": \"0\", \"process_kernel_time\": 30.40521, \"process_mem_max_rss\": \"17812979712\", \"process_out_blocks\": \"0\", \"process_user_time\": 117.72077}", "name": "ResourceReport", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.896475Z"}}
{"data": {"command": "dbt build", "completed_at": "2025-10-23T05:40:40.896718Z", "elapsed": 17.520575, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Command `dbt build` succeeded at 01:40:40.896718 after 17.52 seconds", "name": "CommandCompleted", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.896763Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "ae785d26-72ac-463e-a1af-55ceb79e7fd1", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 35370, "thread": "MainThread", "ts": "2025-10-23T05:40:40.896984Z"}}
