{"data": {"log_version": 3, "version": "=1.10.13"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "Running with dbt=1.10.13", "name": "MainReportVersion", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.408060Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt build --select nbr.stg.stg_labs", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2004f08-6784e97", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr", "quiet": "False", "send_anonymous_usage_stats": "False", "static_parser": "True", "target_path": "target/nbr-2004f08-6784e97", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptionsV2(error=[], warn=[], silence=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "running dbt with arguments {'profiles_dir': '/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr', 'log_cache_events': 'False', 'partial_parse': 'True', 'version_check': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt build --select nbr.stg.stg_labs', 'write_json': 'True', 'log_format': 'json', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'False', 'log_path': '/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2004f08-6784e97', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'debug': 'False', 'no_print': 'None', 'quiet': 'False', 'target_path': 'target/nbr-2004f08-6784e97', 'empty': 'False'}", "name": "MainReportArgs", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.410624Z"}}
{"data": {"adapter_name": "duckdb", "adapter_version": "=1.9.6"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "Registered adapter: duckdb=1.9.6", "name": "AdapterRegistered", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.536131Z"}}
{"data": {"checksum": "9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe", "profile": "", "target": "", "vars": "{}", "version": "1.10.13"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13", "name": "StateCheckVarsHash", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.579230Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.621723Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.621989Z"}}
{"data": {"artifact_path": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2004f08-6784e97/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Wrote artifact WritableManifest to /Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2004f08-6784e97/manifest.json", "name": "ArtifactWritten", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.661025Z"}}
{"data": {"artifact_path": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2004f08-6784e97/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Wrote artifact SemanticManifest to /Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2004f08-6784e97/semantic_manifest.json", "name": "ArtifactWritten", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.661898Z"}}
{"data": {"stat_line": "7 models, 7 sources, 444 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "Found 7 models, 7 sources, 444 macros", "name": "FoundStats", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.681429Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "", "name": "Formatting", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.682068Z"}}
{"data": {"node_count": 1, "num_threads": 1, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "Concurrency: 1 threads (target='dev')", "name": "ConcurrencyLine", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.682221Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "", "name": "Formatting", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.682343Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Acquiring new duckdb connection 'master'", "name": "NewConnection", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.682548Z"}}
{"data": {"conn_name": "list_mimic4", "conn_type": "duckdb"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Acquiring new duckdb connection 'list_mimic4'", "name": "NewConnection", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.682960Z"}}
{"data": {"conn_name": "list_mimic4", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"list_mimic4\"", "name": "ConnectionUsed", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.726719Z"}}
{"data": {"conn_name": "list_mimic4", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"list_mimic4\"} */\n\n    \n    select schema_name\n    from system.information_schema.schemata\n    \n    where lower(catalog_name) = '\"mimic4\"'\n    \n  \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On list_mimic4: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"list_mimic4\"} */\n\n    \n    select schema_name\n    from system.information_schema.schemata\n    \n    where lower(catalog_name) = '\"mimic4\"'\n    \n  \n  ", "name": "SQLQuery", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.726991Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.727163Z"}}
{"data": {"elapsed": 0.009157959, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.009 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.736365Z"}}
{"data": {"conn_name": "list_mimic4"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On list_mimic4: Close", "name": "ConnectionClosed", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.737160Z"}}
{"data": {"conn_name": "create_mimic4_main", "orig_conn_name": "list_mimic4"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_mimic4, now create_mimic4_main)", "name": "ConnectionReused", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.737519Z"}}
{"data": {"relation": {"database": "mimic4", "identifier": "", "schema": "main"}}, "info": {"category": "", "code": "E020", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Creating schema \"database: \"mimic4\"\nschema: \"main\"\n\"", "name": "SchemaCreation", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.737738Z"}}
{"data": {"conn_name": "create_mimic4_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"create_mimic4_main\"", "name": "ConnectionUsed", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.740488Z"}}
{"data": {"conn_name": "create_mimic4_main", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"create_mimic4_main\"} */\n\n    \n        select type from duckdb_databases()\n        where lower(database_name)='mimic4'\n        and type='sqlite'\n    \n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On create_mimic4_main: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"create_mimic4_main\"} */\n\n    \n        select type from duckdb_databases()\n        where lower(database_name)='mimic4'\n        and type='sqlite'\n    \n  ", "name": "SQLQuery", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.740708Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.740864Z"}}
{"data": {"elapsed": 0.000487083, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.741357Z"}}
{"data": {"conn_name": "create_mimic4_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"create_mimic4_main\"", "name": "ConnectionUsed", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.741898Z"}}
{"data": {"conn_name": "create_mimic4_main", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On create_mimic4_main: BEGIN", "name": "SQLQuery", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.742044Z"}}
{"data": {"elapsed": 8.4666004e-05, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.742275Z"}}
{"data": {"conn_name": "create_mimic4_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"create_mimic4_main\"", "name": "ConnectionUsed", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.742418Z"}}
{"data": {"conn_name": "create_mimic4_main", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"create_mimic4_main\"} */\n\n    \n    \n        create schema if not exists \"mimic4\".\"main\"\n    "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On create_mimic4_main: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"create_mimic4_main\"} */\n\n    \n    \n        create schema if not exists \"mimic4\".\"main\"\n    ", "name": "SQLQuery", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.742553Z"}}
{"data": {"elapsed": 0.000305667, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.742993Z"}}
{"data": {"conn_name": "create_mimic4_main"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On create_mimic4_main: COMMIT", "name": "SQLCommit", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.743306Z"}}
{"data": {"conn_name": "create_mimic4_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"create_mimic4_main\"", "name": "ConnectionUsed", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.743450Z"}}
{"data": {"conn_name": "create_mimic4_main", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On create_mimic4_main: COMMIT", "name": "SQLQuery", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.743578Z"}}
{"data": {"elapsed": 6.3459e-05, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.743773Z"}}
{"data": {"conn_name": "create_mimic4_main"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On create_mimic4_main: Close", "name": "ConnectionClosed", "pid": 35325, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-10-23T05:39:58.743920Z"}}
{"data": {"conn_name": "list_mimic4_main", "orig_conn_name": "create_mimic4_main"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Re-using an available connection from the pool (formerly create_mimic4_main, now list_mimic4_main)", "name": "ConnectionReused", "pid": 35325, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:39:58.746347Z"}}
{"data": {"conn_name": "list_mimic4_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"list_mimic4_main\"", "name": "ConnectionUsed", "pid": 35325, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:39:58.748508Z"}}
{"data": {"conn_name": "list_mimic4_main", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On list_mimic4_main: BEGIN", "name": "SQLQuery", "pid": 35325, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:39:58.748664Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 35325, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:39:58.748787Z"}}
{"data": {"elapsed": 0.000238834, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:39:58.749032Z"}}
{"data": {"conn_name": "list_mimic4_main", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"list_mimic4_main\"", "name": "ConnectionUsed", "pid": 35325, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:39:58.749156Z"}}
{"data": {"conn_name": "list_mimic4_main", "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"list_mimic4_main\"} */\nselect\n      'mimic4' as database,\n      table_name as name,\n      table_schema as schema,\n      CASE table_type\n        WHEN 'BASE TABLE' THEN 'table'\n        WHEN 'VIEW' THEN 'view'\n        WHEN 'LOCAL TEMPORARY' THEN 'table'\n        END as type\n    from system.information_schema.tables\n    where lower(table_schema) = 'main'\n    and lower(table_catalog) = 'mimic4'\n  "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On list_mimic4_main: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"connection_name\": \"list_mimic4_main\"} */\nselect\n      'mimic4' as database,\n      table_name as name,\n      table_schema as schema,\n      CASE table_type\n        WHEN 'BASE TABLE' THEN 'table'\n        WHEN 'VIEW' THEN 'view'\n        WHEN 'LOCAL TEMPORARY' THEN 'table'\n        END as type\n    from system.information_schema.tables\n    where lower(table_schema) = 'main'\n    and lower(table_catalog) = 'mimic4'\n  ", "name": "SQLQuery", "pid": 35325, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:39:58.749275Z"}}
{"data": {"elapsed": 0.00587275, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.006 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:39:58.755446Z"}}
{"data": {"conn_name": "list_mimic4_main"}, "info": {"category": "", "code": "E012", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On list_mimic4_main: ROLLBACK", "name": "Rollback", "pid": 35325, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:39:58.756225Z"}}
{"data": {"conn_name": "list_mimic4_main", "exc_info": "Traceback (most recent call last):\n  File \"/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/.venv/lib/python3.13/site-packages/dbt/adapters/base/connections.py\", line 328, in _rollback_handle\n    connection.handle.rollback()\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'DuckDBConnectionWrapper' object has no attribute 'rollback'\n"}, "info": {"category": "", "code": "E009", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Failed to rollback 'list_mimic4_main'", "name": "RollbackFailed", "pid": 35325, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:39:58.757151Z"}}
{"data": {"conn_name": "list_mimic4_main"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On list_mimic4_main: Close", "name": "ConnectionClosed", "pid": 35325, "thread": "ThreadPoolExecutor-1_0", "ts": "2025-10-23T05:39:58.757363Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"master\"", "name": "ConnectionUsed", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.758173Z"}}
{"data": {"conn_name": "master", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On master: BEGIN", "name": "SQLQuery", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.758324Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.758461Z"}}
{"data": {"elapsed": 0.00028066698, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.758759Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.758985Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"master\"", "name": "ConnectionUsed", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.759146Z"}}
{"data": {"conn_name": "master", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On master: COMMIT", "name": "SQLQuery", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.759373Z"}}
{"data": {"elapsed": 0.00010775, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.759650Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.759818Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "started", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Began running node model.nbr.stg_labs", "name": "NodeStart", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.761290Z"}}
{"data": {"description": "sql view model main.stg_labs", "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "started", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "1 of 1 START sql view model main.stg_labs ...................................... [RUN]", "name": "LogStartLine", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.761590Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "orig_conn_name": "list_mimic4_main"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_mimic4_main, now model.nbr.stg_labs)", "name": "ConnectionReused", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.761835Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Began compiling node model.nbr.stg_labs", "name": "NodeCompiling", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.762Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "compiling", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Writing injected SQL for node \"model.nbr.stg_labs\"", "name": "WritingInjectedSQLForNode", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.765549Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Began executing node model.nbr.stg_labs", "name": "NodeExecuting", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.766135Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.nbr.stg_labs\"", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Writing runtime sql for node \"model.nbr.stg_labs\"", "name": "JinjaLogDebug", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.779162Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "conn_type": "duckdb", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"model.nbr.stg_labs\"", "name": "ConnectionUsed", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.779895Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On model.nbr.stg_labs: BEGIN", "name": "SQLQuery", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.780102Z"}}
{"data": {"connection_state": "closed", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.780279Z"}}
{"data": {"elapsed": 0.000359708, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.780646Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "conn_type": "duckdb", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"model.nbr.stg_labs\"", "name": "ConnectionUsed", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.780835Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"node_id\": \"model.nbr.stg_labs\"} */\n\n  \n  create view \"mimic4\".\"main\".\"stg_labs__dbt_tmp\" as (\n    \n\n/*\nStaging: Lab Events (\u68c0\u9a8c\u7ed3\u679c) - \u6700\u590d\u6742\u7684\u5904\u7406\n\n\u529f\u80fd:\n1. Top-200 \u8fc7\u6ee4\uff1a\u53ea\u4fdd\u7559\u6700\u5e38\u89c1\u7684 200 \u79cd\u68c0\u9a8c\n2. \"\u635e\u56de\"\u7b56\u7565\uff1a\u627e\u56de\u5165\u9662\u524d 24 \u5c0f\u65f6\u7684\u68c0\u9a8c\n3. \u6570\u503c\u5206\u7bb1\uff1aQ1-Q10 \u5206\u4f4d\u6570\u79bb\u6563\u5316\uff08ETHOS \u65b9\u6cd5\uff09\n\nETHOS \u7b56\u7565:\n- \u8fde\u7eed\u6570\u503c \u2192 \u79bb\u6563\u7c7b\u522b\uff08Q1-Q10\uff09\n- \u4fdd\u7559 NULL \u503c\u4f5c\u4e3a\u5355\u72ec\u7c7b\u522b\n- \u8bcd\u8868: 200 itemid \u00d7 11 \u72b6\u6001 = 2200 \u4e2a lab tokens\n\n\u8f93\u51fa:\n- \u6bcf\u884c = \u4e00\u4e2a\u68c0\u9a8c\u7ed3\u679c\uff08\u5df2\u5206\u7bb1\uff09\n- code \u683c\u5f0f: LAB:itemid_Q5\n- \u5305\u542b\u7cbe\u786e charttime\n*/\n\n-- ============================================================================\n-- Step 1: \u6269\u5c55\u68c0\u9a8c\u6570\u636e\uff08\u539f\u6709 + \u635e\u56de\uff09\n-- ============================================================================\nwith labs_original as (\n    -- 1.1 \u539f\u672c\u6709 hadm_id \u7684\u4f4f\u9662\u68c0\u9a8c\n    select \n        subject_id,\n        hadm_id,\n        itemid,\n        charttime,\n        valuenum\n    from \"mimic4\".\"main\".\"raw_labevents\"\n    where hadm_id is not null\n        and itemid in (select itemid from \"mimic4\".\"main\".\"top_200_labs\")\n),\n\nlabs_reclaimed_raw as (\n    -- 1.2 \"\u635e\u56de\"\u5019\u9009\uff1a\u5165\u9662\u524d 24 \u5c0f\u65f6\u7684\u68c0\u9a8c\n    select \n        l.labevent_id,\n        l.subject_id,\n        a.hadm_id,  -- \u5206\u914d hadm_id\n        l.itemid,\n        l.charttime,\n        l.valuenum,\n        a.admittime,\n        abs(extract(epoch from (l.charttime - a.admittime))) as time_diff_seconds\n    from \"mimic4\".\"main\".\"raw_labevents\" l\n    join \"mimic4\".\"main\".\"stg_admissions\" a \n        on l.subject_id = a.subject_id\n        and l.hadm_id is null  -- \u539f\u672c\u6ca1\u6709 hadm_id\n        and l.charttime >= (a.admittime - interval '24 hours')\n        and l.charttime <= a.admittime\n    where l.itemid in (select itemid from \"mimic4\".\"main\".\"top_200_labs\")\n),\n\nlabs_reclaimed as (\n    -- 1.3 \u6bcf\u4e2a\u68c0\u9a8c\u53ea\u5206\u914d\u7ed9\u6700\u8fd1\u7684\u5c31\u8bca\n    select \n        subject_id,\n        hadm_id,\n        itemid,\n        charttime,\n        valuenum\n    from (\n        select \n            *,\n            row_number() over (partition by labevent_id order by time_diff_seconds) as rn\n        from labs_reclaimed_raw\n    ) ranked\n    where rn = 1\n),\n\nlabs_extended as (\n    -- 1.4 \u5408\u5e76\u539f\u6709\u548c\u635e\u56de\u7684\n    select * from labs_original\n    union all\n    select * from labs_reclaimed\n),\n\n-- ============================================================================\n-- Step 2: \u6570\u503c\u5206\u7bb1\uff08Q1-Q10\uff09\n-- ============================================================================\nlabs_binned as (\n    select \n        l.subject_id,\n        l.hadm_id,\n        l.itemid,\n        l.charttime,\n        l.valuenum,\n        -- \u5206\u7bb1\u903b\u8f91\uff0811\u4e2a\u7c7b\u522b\uff09\n        case \n            when l.valuenum is null then 'LAB:' || l.itemid || '_NULL'\n            when l.valuenum <= q.q1 then 'LAB:' || l.itemid || '_Q1'\n            when l.valuenum <= q.q2 then 'LAB:' || l.itemid || '_Q2'\n            when l.valuenum <= q.q3 then 'LAB:' || l.itemid || '_Q3'\n            when l.valuenum <= q.q4 then 'LAB:' || l.itemid || '_Q4'\n            when l.valuenum <= q.q5 then 'LAB:' || l.itemid || '_Q5'\n            when l.valuenum <= q.q6 then 'LAB:' || l.itemid || '_Q6'\n            when l.valuenum <= q.q7 then 'LAB:' || l.itemid || '_Q7'\n            when l.valuenum <= q.q8 then 'LAB:' || l.itemid || '_Q8'\n            when l.valuenum <= q.q9 then 'LAB:' || l.itemid || '_Q9'\n            else 'LAB:' || l.itemid || '_Q10'\n        end as code\n    from labs_extended l\n    left join \"mimic4\".\"main\".\"lab_quantiles\" q \n        on l.itemid = q.itemid\n)\n\n-- ============================================================================\n-- Step 3: \u6700\u7ec8\u8f93\u51fa\n-- ============================================================================\nselect \n    subject_id,\n    hadm_id,\n    code,\n    'lab' as code_type,\n    charttime as event_time,  -- \u68c0\u9a8c\u65f6\u95f4\uff08\u79d2\u7ea7\u7cbe\u5ea6\uff09\n    row_number() over (\n        partition by subject_id, hadm_id \n        order by charttime\n    ) as seq_num\nfrom labs_binned\n  );\n"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On model.nbr.stg_labs: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"node_id\": \"model.nbr.stg_labs\"} */\n\n  \n  create view \"mimic4\".\"main\".\"stg_labs__dbt_tmp\" as (\n    \n\n/*\nStaging: Lab Events (\u68c0\u9a8c\u7ed3\u679c) - \u6700\u590d\u6742\u7684\u5904\u7406\n\n\u529f\u80fd:\n1. Top-200 \u8fc7\u6ee4\uff1a\u53ea\u4fdd\u7559\u6700\u5e38\u89c1\u7684 200 \u79cd\u68c0\u9a8c\n2. \"\u635e\u56de\"\u7b56\u7565\uff1a\u627e\u56de\u5165\u9662\u524d 24 \u5c0f\u65f6\u7684\u68c0\u9a8c\n3. \u6570\u503c\u5206\u7bb1\uff1aQ1-Q10 \u5206\u4f4d\u6570\u79bb\u6563\u5316\uff08ETHOS \u65b9\u6cd5\uff09\n\nETHOS \u7b56\u7565:\n- \u8fde\u7eed\u6570\u503c \u2192 \u79bb\u6563\u7c7b\u522b\uff08Q1-Q10\uff09\n- \u4fdd\u7559 NULL \u503c\u4f5c\u4e3a\u5355\u72ec\u7c7b\u522b\n- \u8bcd\u8868: 200 itemid \u00d7 11 \u72b6\u6001 = 2200 \u4e2a lab tokens\n\n\u8f93\u51fa:\n- \u6bcf\u884c = \u4e00\u4e2a\u68c0\u9a8c\u7ed3\u679c\uff08\u5df2\u5206\u7bb1\uff09\n- code \u683c\u5f0f: LAB:itemid_Q5\n- \u5305\u542b\u7cbe\u786e charttime\n*/\n\n-- ============================================================================\n-- Step 1: \u6269\u5c55\u68c0\u9a8c\u6570\u636e\uff08\u539f\u6709 + \u635e\u56de\uff09\n-- ============================================================================\nwith labs_original as (\n    -- 1.1 \u539f\u672c\u6709 hadm_id \u7684\u4f4f\u9662\u68c0\u9a8c\n    select \n        subject_id,\n        hadm_id,\n        itemid,\n        charttime,\n        valuenum\n    from \"mimic4\".\"main\".\"raw_labevents\"\n    where hadm_id is not null\n        and itemid in (select itemid from \"mimic4\".\"main\".\"top_200_labs\")\n),\n\nlabs_reclaimed_raw as (\n    -- 1.2 \"\u635e\u56de\"\u5019\u9009\uff1a\u5165\u9662\u524d 24 \u5c0f\u65f6\u7684\u68c0\u9a8c\n    select \n        l.labevent_id,\n        l.subject_id,\n        a.hadm_id,  -- \u5206\u914d hadm_id\n        l.itemid,\n        l.charttime,\n        l.valuenum,\n        a.admittime,\n        abs(extract(epoch from (l.charttime - a.admittime))) as time_diff_seconds\n    from \"mimic4\".\"main\".\"raw_labevents\" l\n    join \"mimic4\".\"main\".\"stg_admissions\" a \n        on l.subject_id = a.subject_id\n        and l.hadm_id is null  -- \u539f\u672c\u6ca1\u6709 hadm_id\n        and l.charttime >= (a.admittime - interval '24 hours')\n        and l.charttime <= a.admittime\n    where l.itemid in (select itemid from \"mimic4\".\"main\".\"top_200_labs\")\n),\n\nlabs_reclaimed as (\n    -- 1.3 \u6bcf\u4e2a\u68c0\u9a8c\u53ea\u5206\u914d\u7ed9\u6700\u8fd1\u7684\u5c31\u8bca\n    select \n        subject_id,\n        hadm_id,\n        itemid,\n        charttime,\n        valuenum\n    from (\n        select \n            *,\n            row_number() over (partition by labevent_id order by time_diff_seconds) as rn\n        from labs_reclaimed_raw\n    ) ranked\n    where rn = 1\n),\n\nlabs_extended as (\n    -- 1.4 \u5408\u5e76\u539f\u6709\u548c\u635e\u56de\u7684\n    select * from labs_original\n    union all\n    select * from labs_reclaimed\n),\n\n-- ============================================================================\n-- Step 2: \u6570\u503c\u5206\u7bb1\uff08Q1-Q10\uff09\n-- ============================================================================\nlabs_binned as (\n    select \n        l.subject_id,\n        l.hadm_id,\n        l.itemid,\n        l.charttime,\n        l.valuenum,\n        -- \u5206\u7bb1\u903b\u8f91\uff0811\u4e2a\u7c7b\u522b\uff09\n        case \n            when l.valuenum is null then 'LAB:' || l.itemid || '_NULL'\n            when l.valuenum <= q.q1 then 'LAB:' || l.itemid || '_Q1'\n            when l.valuenum <= q.q2 then 'LAB:' || l.itemid || '_Q2'\n            when l.valuenum <= q.q3 then 'LAB:' || l.itemid || '_Q3'\n            when l.valuenum <= q.q4 then 'LAB:' || l.itemid || '_Q4'\n            when l.valuenum <= q.q5 then 'LAB:' || l.itemid || '_Q5'\n            when l.valuenum <= q.q6 then 'LAB:' || l.itemid || '_Q6'\n            when l.valuenum <= q.q7 then 'LAB:' || l.itemid || '_Q7'\n            when l.valuenum <= q.q8 then 'LAB:' || l.itemid || '_Q8'\n            when l.valuenum <= q.q9 then 'LAB:' || l.itemid || '_Q9'\n            else 'LAB:' || l.itemid || '_Q10'\n        end as code\n    from labs_extended l\n    left join \"mimic4\".\"main\".\"lab_quantiles\" q \n        on l.itemid = q.itemid\n)\n\n-- ============================================================================\n-- Step 3: \u6700\u7ec8\u8f93\u51fa\n-- ============================================================================\nselect \n    subject_id,\n    hadm_id,\n    code,\n    'lab' as code_type,\n    charttime as event_time,  -- \u68c0\u9a8c\u65f6\u95f4\uff08\u79d2\u7ea7\u7cbe\u5ea6\uff09\n    row_number() over (\n        partition by subject_id, hadm_id \n        order by charttime\n    ) as seq_num\nfrom labs_binned\n  );\n", "name": "SQLQuery", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.781062Z"}}
{"data": {"elapsed": 0.00180125, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.002 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.783141Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "conn_type": "duckdb", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"model.nbr.stg_labs\"", "name": "ConnectionUsed", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.785449Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"node_id\": \"model.nbr.stg_labs\"} */\nalter view \"mimic4\".\"main\".\"stg_labs__dbt_tmp\" rename to \"stg_labs\""}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On model.nbr.stg_labs: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"node_id\": \"model.nbr.stg_labs\"} */\nalter view \"mimic4\".\"main\".\"stg_labs__dbt_tmp\" rename to \"stg_labs\"", "name": "SQLQuery", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.785641Z"}}
{"data": {"elapsed": 0.000285292, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.786099Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On model.nbr.stg_labs: COMMIT", "name": "SQLCommit", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.818084Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "conn_type": "duckdb", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"model.nbr.stg_labs\"", "name": "ConnectionUsed", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.818366Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On model.nbr.stg_labs: COMMIT", "name": "SQLQuery", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.818547Z"}}
{"data": {"elapsed": 0.000811125, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.001 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.819557Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "conn_type": "duckdb", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"model.nbr.stg_labs\"", "name": "ConnectionUsed", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.821812Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "sql": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"node_id\": \"model.nbr.stg_labs\"} */\n\n      drop view if exists \"mimic4\".\"main\".\"stg_labs__dbt_backup\" cascade\n    "}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On model.nbr.stg_labs: /* {\"app\": \"dbt\", \"dbt_version\": \"1.10.13\", \"profile_name\": \"nbr\", \"target_name\": \"dev\", \"node_id\": \"model.nbr.stg_labs\"} */\n\n      drop view if exists \"mimic4\".\"main\".\"stg_labs__dbt_backup\" cascade\n    ", "name": "SQLQuery", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.822027Z"}}
{"data": {"elapsed": 0.00013904201, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.822359Z"}}
{"data": {"conn_name": "model.nbr.stg_labs", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "executing", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On model.nbr.stg_labs: Close", "name": "ConnectionClosed", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.823524Z"}}
{"data": {"description": "sql view model main.stg_labs", "execution_time": 0.06203699, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "2025-10-23T05:39:58.823810", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "success", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "status": "OK", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "1 of 1 OK created sql view model main.stg_labs ................................. [\u001b[32mOK\u001b[0m in 0.06s]", "name": "LogModelResult", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.824690Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "943f003339e010c18c1ca49a5bc5a4ba0d33ce4cc6a6681523007df64563bf40", "node_finished_at": "2025-10-23T05:39:58.823810", "node_name": "stg_labs", "node_path": "stg/stg_labs.sql", "node_relation": {"alias": "stg_labs", "database": "mimic4", "relation_name": "\"mimic4\".\"main\".\"stg_labs\"", "schema": "main"}, "node_started_at": "2025-10-23T05:39:58.761230", "node_status": "success", "resource_type": "model", "unique_id": "model.nbr.stg_labs"}, "run_result": {"adapter_response": {"_message": "OK"}, "execution_time": 0.06203699, "message": "OK", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2025-10-23T05:39:58.766094Z", "name": "compile", "started_at": "2025-10-23T05:39:58.762144Z"}, {"completed_at": "2025-10-23T05:39:58.823459Z", "name": "execute", "started_at": "2025-10-23T05:39:58.766289Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Finished running node model.nbr.stg_labs", "name": "NodeFinished", "pid": 35325, "thread": "Thread-1 (worker)", "ts": "2025-10-23T05:39:58.825039Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"master\"", "name": "ConnectionUsed", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.825724Z"}}
{"data": {"conn_name": "master", "sql": "BEGIN"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On master: BEGIN", "name": "SQLQuery", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.825889Z"}}
{"data": {"connection_state": "closed"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Opening a new connection, currently in state closed", "name": "NewConnectionOpening", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.826034Z"}}
{"data": {"elapsed": 0.000273916, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.826312Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E018", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On master: COMMIT", "name": "SQLCommit", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.826464Z"}}
{"data": {"conn_name": "master", "conn_type": "duckdb"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Using duckdb connection \"master\"", "name": "ConnectionUsed", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.826603Z"}}
{"data": {"conn_name": "master", "sql": "COMMIT"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On master: COMMIT", "name": "SQLQuery", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.826784Z"}}
{"data": {"elapsed": 9.6125e-05, "query_id": "", "status": "OK"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "SQL status: OK in 0.000 seconds", "name": "SQLQueryStatus", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.827033Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "On master: Close", "name": "ConnectionClosed", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.827179Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.827348Z"}}
{"data": {"conn_name": "model.nbr.stg_labs"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Connection 'model.nbr.stg_labs' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.827469Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "", "name": "Formatting", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.827601Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 0.15 seconds", "execution_time": 0.1451273, "stat_line": "1 view model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).", "name": "FinishedRunningStats", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.827736Z"}}
{"data": {"elapsed_time": 0.1451273, "generated_at": "2025-10-23T05:39:58Z", "results": [{"adapter_response": {"_message": "OK"}, "execution_time": 0.06203699, "message": "OK", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2025-10-23T05:39:58.766094Z", "name": "compile", "started_at": "2025-10-23T05:39:58.762144Z"}, {"completed_at": "2025-10-23T05:39:58.823459Z", "name": "execute", "started_at": "2025-10-23T05:39:58.766289Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.828018Z"}}
{"data": {"artifact_path": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2004f08-6784e97/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Wrote artifact WritableManifest to /Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2004f08-6784e97/manifest.json", "name": "ArtifactWritten", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.835994Z"}}
{"data": {"artifact_path": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2004f08-6784e97/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Wrote artifact SemanticManifest to /Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2004f08-6784e97/semantic_manifest.json", "name": "ArtifactWritten", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.836851Z"}}
{"data": {"artifact_path": "/Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2004f08-6784e97/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /Users/gin/Desktop/HAT/ehr-fm/dataset/mimic4/transform/nbr/target/nbr-2004f08-6784e97/run_results.json", "name": "ArtifactWritten", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.839534Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "", "name": "Formatting", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.839746Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.839937Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "", "name": "Formatting", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.840085Z"}}
{"data": {"stats": {"error": 0, "noop": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1", "name": "StatsLine", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.840240Z"}}
{"data": {"command_name": "build", "command_success": true, "command_wall_clock_time": 0.46999446, "process_in_blocks": "0", "process_kernel_time": 0.162786, "process_mem_max_rss": "156745728", "process_out_blocks": "0", "process_user_time": 0.845911}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Resource report: {\"command_name\": \"build\", \"command_success\": true, \"command_wall_clock_time\": 0.46999446, \"process_in_blocks\": \"0\", \"process_kernel_time\": 0.162786, \"process_mem_max_rss\": \"156745728\", \"process_out_blocks\": \"0\", \"process_user_time\": 0.845911}", "name": "ResourceReport", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.841009Z"}}
{"data": {"command": "dbt build", "completed_at": "2025-10-23T05:39:58.841185Z", "elapsed": 0.47023034, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Command `dbt build` succeeded at 01:39:58.841185 after 0.47 seconds", "name": "CommandCompleted", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.841223Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "66b4f6d2-1323-48d9-a137-70149fd28546", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 35325, "thread": "MainThread", "ts": "2025-10-23T05:39:58.841405Z"}}
